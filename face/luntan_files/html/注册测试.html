<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 10px;
            background: linear-gradient(to right, #ecf, #8cf);
            transition: all 0.5s ease;
        }

        html::before {
            content: "";
            position: fixed;
            height: 100%;
            width: 100%;
            z-index: -1;
            backdrop-filter: blur(5px);
        }

        ::selection {
            color: #fff;
            background-color: #6cf;
        }

        .logon {
            display: flex;
            overflow: hidden;
            width: 700px;
            height: 450px;
            background-color: rgb(255, 2555, 255, 85%);
            border-radius: 10px;
            box-shadow: 0 0 5px 10px rgb(0, 0, 0 / 10%);
            margin: 10% auto;
        }

        .close {
            opacity: 0;
        }

        .logon .left {
            position: relative;
            width: 35%;
            height: 100%;
            background-color: skyblue;
        }

        .logon .left::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url("../img/Bg4.jpg");
            background-size: cover;
            opacity: 80%;
        }

        .logon .right-1 {
            display: flex;
            width: 65%;
            padding: 0 5%;
            flex-direction: column;
            align-items: center;
        }

        .logon .right-1 form {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .logon .right-1 h4 {
            font-size: 25px;
            color: #6cf;
            margin-top: 20px;
        }

        .logon .right-1 form .acc {
            outline: none;
            width: 80%;
            height: 30px;
            font-size: 15px;
            margin-top: 10%;
            padding: 10px 0 0 15px;
            border: none;
            border-bottom: 1px solid #6cf;
            color: #6cf;
            background-color: rgb(0, 0, 0, 0);
        }

        .logon .right-1 form .acc:hover {
            outline: none;
            padding: 10px 0 0 15px;
            color: #6cf;
        }

        .right-1 .Login {
            width: 60%;
            height: 30px;
            color: #fff;
            background-image: linear-gradient(120deg, #ecf 0%, #8cf 100%);
            font-size: 15px;
            border: none;
            border-radius: 5px;
            margin: 50px 0 0 50%;
            transform: translateX(-50%);
            cursor: pointer;
        }

        .right-1 .Login:hover {
            box-shadow: 0 0 2px -1px rgb(0 0 0 / 15%);
        }

        .right-1 .fn {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            width: 70%;
        }

        .right-1 .fn a {
            font-size: 12px;
            margin-top: 10px;
            padding: 2px 5px;
            color: #666;
        }

        .right-1 .fn a:hover {
            color: #6cf;
        }

        .right-2 {
            animation: move 1s ease;
        }

        .logon .right-2 {
            display: flex;
            width: 65%;
            padding: 0 5%;
            flex-direction: column;
            align-items: center;
        }

        .logon .right-2 form {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .logon .right-2 form .acc {
            outline: none;
            width: 85%;
            height: 30px;
            font-size: 15px;
            margin-top: 10%;
            padding: 10px 0 0 15px;
            border: none;
            border-bottom: 1px solid #6cf;
            color: #6cf;
            background-color: rgb(0, 0, 0, 0);
        }

        .right-2 .form-text{
            font: 600 20px '';
            color: #ecf;
            margin-top: 12%;
        }

        .logon .right-2 form .bir{
            width: 20%;
            margin-top: 10%;
            margin-bottom: 10%;
        }
        
        .right-2 .sex{
            width: 30%;
        }

        .right-2 .address{
            width: 25%;
            border: 1px solid #ecf;
        }

        .right-2 .sex{
            width: 25%;
            border: 1px solid #ecf;
            background-color: rgb(255, 255, 255, 50%);
        }

        .right-2 .submit{
            width: 80%;
            height: 10%;
            padding: 0 10%;
            background-image: linear-gradient(120deg, #6cf 0%, #ecf 100%);
            border: none;
            border-radius: 5px;
            margin-top: 5%;
            cursor: pointer;
        }

        .right-2 .button{
            width: 30%;
            height: 10%;
            background-color: #ecf;
            border: none;
            border-radius: 5px;
            margin: 10% 0 0 50%;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="logon">
        <div class="left">
        </div>
        <div class="right-1" v-if="r1">
            <h4>Welcome</h4>
            <form>
                <input class="acc" id="username" type="text" placeholder="用户名">
                <input class="acc" id="password" type="password" placeholder="密码">
                <input class="Login" type="submit" value="Login">
            </form>
            <div class="fn">
                <a href="#" id="toright" @click="rt1">注册账户</a>
                <a href="#">忘记密码</a>
            </div>
        </div>
        <div class="right-2" v-if="r2">
            <form id="form-logon">
                <input class="acc" type="text" id="logon-count" placeholder="用户名">
                <input class="acc" type="text" id="logon-password" placeholder="密码">
                <span class="form-text">生日：</span>
                <input class="acc bir" type="text" id="birthday-y" placeholder="年">
                <input class="acc bir" type="text" id="birthday-m" placeholder="月">
                <input class="acc bir" type="text" id="birthday-d" placeholder="日">

                <select id="sex" class="sex">
                    <option value="男">男</option>
                    <option value="女">女</option>
                    <option value="保密">保密</option>
                </select>
                <select id="province" class="address">
                    <option value="--">--</option>
                </select>
                <select id="city" class="address">
                    <option value="--">--</option>
                </section>
                    <input type="submit" value="注册" id="logon-button" class="submit" @click="post">
                    <input type="button" value="返回登入" id="backtologon" class="button" @click="rt2">
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
    <script>
        //登录注册切换
        const test = new Vue({
            el: '.logon',
            data: {
                r1: true,
                r2: false
            },
            methods: {
                rt1() {
                    this.r1 = !this.r1;
                    this.r2 = !this.r2;
                },
                rt2() {
                    this.r1 = !this.r1;
                    this.r2 = !this.r2;
                },
                post() {

                    const xhr = new XMLHttpRequest();

                    document.getElementById("logon-button").addEventListener("loadend", function(){

                    xhr.open("post","http://127.0.0.1:8080/sign_up", true);
                    xhr.setRequestHeader("Content-Type", "application/json");
         
                    const logoncount = document.getElementById("logon-count").value;
                    const logonpassword = document.getElementById("logon-password").value;
                    const birthdayy = document.getElementById("birthday-y").value;
                    const birthdaym = document.getElementById("birthday-m").value;
                    const birthdayd = document.getElementById("birthday-d").value;
                    const sex = document.getElementById("sex").value;
                    const province = document.getElementById("province").value;
                    const city = document.getElementById("city").value;

                    const data = {
                        logoncount,
                        logonpassword,
                        birthdayy,
                        birthdaym,
                        birthdayd,
                        sex,
                        province,
                        city
                    };
                    xhr.send(JSON.stringify(data));
                    })

                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log(xhr.responseText);
                    }}                    
                }
            }
        });

        //省份城市请求
        const xhr = new XMLHttpRequest();
        const xhr2 = new XMLHttpRequest();
        const logon = document.getElementById("toright");

        xhr.open("get", "http://hmajax.itheima.net/api/province");
        logon.addEventListener("click", function () {
            const d = JSON.parse(xhr.response);
            const data = d.list;
            for (i = 0; i < data.length; i++) {
                const a = document.createElement("option");
                a.text = data[i];
                a.value = data[i];
                document.getElementById("province").appendChild(a);
            }
        })
        xhr.send();

        xhr2.open("get", "http://hmajax.itheima.net/api/city?pname=江西省");
        logon.addEventListener("click", function () {
            const d = JSON.parse(xhr2.response);
            const data = d.list;
            for (i = 0; i < data.length; i++) {
                const a = document.createElement("option");
                a.text = data[i];
                a.value = data[i];
                document.getElementById("city").appendChild(a);
            }
        })
        logon.addEventListener("click", function () {
            const d = JSON.parse(xhr2.response);
            const data = d.list;
            for (i = 0; i < data.length; i++) {
                const a = document.createElement("option");
                a.text = data[i];
                a.value = data[i];
                document.getElementById("city").appendChild(a);
            }
            i = 0;
        })
        xhr2.send();

        //背景颜色切换
        function bgchange() {
            const html = document.documentElement
            const img = [
                'linear-gradient(to right, #ecf, #8cf)',
                'linear-gradient(to right, #abdcff, #0396ff)',
                'linear-gradient(to right, #ce9ffc, #7367f0)',
                'linear-gradient(to right, #f97794, #623aa2)'
            ]
            const image = img[Math.floor(Math.random() * img.length)];
            console.log(image);

            html.style.background = image;
        }

        // setInterval(bgchange, 3000);

        //Post
        // 这是一个触发发送请求的事件处理函数
        document.getElementsByClassName("Login")[0].addEventListener("click", function () {
            // 获取动态变化的变量值
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            // 创建 XMLHttpRequest 对象
            const xhr = new XMLHttpRequest();

            // 设置请求方法和URL
            xhr.open("POST", "http://127.0.0.1:8080/sign_up", true);
            // 设置请求头
            xhr.setRequestHeader("Content-Type", "application/json");
            // 准备要发送的数据
            const data = {
                username,
                password
            };

            // 发送数据给服务器
            xhr.send(JSON.stringify(data));
        })
            // 设置请求的处理函数
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    // 请求成功处理代码
                    console.log(xhr.responseText);
                }
            }        
    </script>
</body>

</html>